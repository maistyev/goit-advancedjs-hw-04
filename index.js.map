{"version":3,"file":"index.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\naxios.defaults.baseURL = 'https://pixabay.com';\n\nconst ENDPOINT = 'api/';\nconst API_KEY = '49481602-fd69c907e71567b02dc237fda';\n\nexport async function getPhotos(query, page = 1, perPage = 15) {\n  const { data } = await axios.get(ENDPOINT, {\n    params: {\n      key: API_KEY,\n      q: encodeURIComponent(query),\n      image_type: 'photo',\n      orientation: 'horizontal',\n      safesearch: true,\n      page,\n      per_page: perPage,\n    },\n  });\n  return data;\n}\n","function getUniqueTags(tagsString) {\n  const tagsArray = tagsString.split(',');\n\n  const trimmedTags = tagsArray.map(tag => tag.trim());\n\n  const uniqueTags = [...new Set(trimmedTags)];\n\n  return uniqueTags;\n}\n\nexport const createGalleryCard = ({\n  webformatURL,\n  largeImageURL,\n  likes,\n  views,\n  comments,\n  downloads,\n  tags,\n}) => {\n  return `\n<li class=\"gallery-item\">\n  <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" title=\"${getUniqueTags(\n    tags\n  ).join(', ')}\"/>\n  </a>\n  <div class=\"stats\">\n    <div class=\"stat\">\n      <p class=\"stat-title\">Likes</p>\n      <p class=\"stat-value\">${likes}</p>\n    </div>\n    <div class=\"stat\">\n      <p class=\"stat-title\">Views</p>\n      <p class=\"stat-value\">${views}</p>\n    </div>\n    <div class=\"stat\">\n      <p class=\"stat-title\">Comments</p>\n      <p class=\"stat-value\">${comments}</p>\n    </div>\n    <div class=\"stat\">\n      <p class=\"stat-title\">Downloads</p>\n      <p class=\"stat-value\">${downloads}</p>\n    </div>\n  </div>\n</li>\n`;\n};\n","import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { getPhotos } from './js/pixabay-api';\nimport { createGalleryCard } from './js/render-functions';\n\nconst refs = {\n  form: document.querySelector('.js-search-form'),\n  input: document.querySelector('.js-search-input'),\n  submitButton: document.querySelector('.js-search-button'),\n  gallery: document.querySelector('.js-gallery'),\n  loader: document.querySelector('.js-loader'),\n  loadMoreButton: document.querySelector('.js-load-more-button'),\n};\n\nlet search = { inputValue: '', page: 1 };\n\nlet galleryBox = new SimpleLightbox('.gallery-link', { captionDelay: 250 });\n\nfunction handleFormSubmit(event) {\n  event.preventDefault();\n  refs.gallery.innerHTML = '';\n  refs.loadMoreButton.classList.remove('active');\n\n  search.inputValue = refs.input.value;\n  search.page = 1;\n\n  if (search.inputValue.trim() === '') {\n    iziToast.error({\n      title: 'Error',\n      message: 'Please enter the search query!',\n    });\n    return;\n  }\n  refs.loader.classList.add('active');\n  getPhotos(search.inputValue)\n    .then(data => {\n      if (data.hits.length === 0) {\n        iziToast.error({\n          title: 'Error',\n          message:\n            'Sorry, there are no images matching your search query. Please try again!',\n        });\n        return;\n      }\n\n      refs.gallery.innerHTML = data.hits\n        .map(imageInfo => createGalleryCard(imageInfo))\n        .join('');\n      galleryBox.refresh();\n      if (data.totalHits > data.hits.length) {\n        refs.loadMoreButton.classList.add('active');\n      }\n    })\n    .catch(error => {\n      iziToast.error({\n        title: 'Error',\n        message: 'Something went wrong. Please try again!',\n      });\n    })\n    .finally(() => {\n      refs.loader.classList.remove('active');\n    });\n  refs.form.reset();\n}\n\nasync function handleLoadMore() {\n  search.page += 1;\n  refs.loader.classList.add('active');\n  window.scrollBy({\n    top: window.innerHeight,\n    left: 0,\n    behavior: 'smooth',\n  });\n  refs.loadMoreButton.classList.remove('active');\n  try {\n    const images = await getPhotos(search.inputValue, search.page);\n    refs.gallery.insertAdjacentHTML(\n      'beforeend',\n      images.hits.map(imageInfo => createGalleryCard(imageInfo)).join('')\n    );\n    galleryBox.refresh();\n\n    if (images.totalHits < search.page * 15) {\n      iziToast.info({\n        title: 'Info',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      refs.loadMoreButton.removeEventListener('click', handleLoadMore);\n    } else {\n      refs.loadMoreButton.classList.add('active');\n    }\n\n    const { height } = document\n      .querySelector('.gallery-item')\n      .getBoundingClientRect();\n\n    window.scrollBy({\n      top: height * 2,\n      left: 0,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'Something went wrong. Please try again!',\n    });\n  } finally {\n    refs.loader.classList.remove('active');\n  }\n}\n\nrefs.form.addEventListener('submit', handleFormSubmit);\nrefs.loadMoreButton.addEventListener('click', handleLoadMore);\n"],"names":["axios","ENDPOINT","API_KEY","getPhotos","query","page","perPage","data","getUniqueTags","tagsString","trimmedTags","tag","createGalleryCard","webformatURL","largeImageURL","likes","views","comments","downloads","tags","refs","search","galleryBox","SimpleLightbox","handleFormSubmit","event","iziToast","imageInfo","error","handleLoadMore","images","height"],"mappings":"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"}